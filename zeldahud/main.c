#include <gb/gb.h>
#include <stdio.h>
#include "zeldaTiles.c"
#include "zeldaMap.c"
#include "tileset.c"
#include "tilemap.c"

void main() {

    // load the windows tiles
    int numHudTiles = 15;
    set_bkg_data(0, numHudTiles, zeldaTiles); // there are 15 tiles in the HUD tile set


    // shift tile set
    // unsigned char modTilemap[] = {0};
    // for(int i = 0; i<=sizeof(mytilemap); i++) {
    //     modTilemap[i] = mytilemap[i] + 0xf;
    // }    
    // the above should work, but doesn't. Working code from online scratch pad:
    // https://cplayground.com/?p=boar-pig-walrus
    const unsigned char modTilemap[] = {0xf, 0x10, 0x11, 0x11, 0x11, 0xf, 0xf, 0xf, 0xf, 0xf, 0xf, 0xf, 0xf, 0xf, 0xf, 0x12, 0x12, 0x12, 0xf, 0xf, 0xf, 0x13, 0xf, 0x13, 0xf, 0x13, 0xf, 0x13, 0xf, 0x13, 0xf, 0x13, 0xf, 0x13, 0xf, 0x13, 0xf, 0x13, 0xf, 0x13, 0x13, 0xf, 0x13, 0xf, 0x13, 0xf, 0x13, 0xf, 0x13, 0xf, 0x13, 0xf, 0x13, 0xf, 0x13, 0xf, 0x13, 0xf, 0x13, 0xf, 0xf, 0x13, 0x14, 0x15, 0x16, 0x17, 0xf, 0x13, 0xf, 0x13, 0xf, 0x13, 0xf, 0x13, 0xf, 0x13, 0xf, 0x13, 0xf, 0x13, 0x13, 0xf, 0x18, 0x19, 0x1a, 0x1b, 0x13, 0x1c, 0x1c, 0x1c, 0x1c, 0x1c, 0x1c, 0xf, 0x14, 0x15, 0x16, 0x17, 0x13, 0xf, 0xf, 0x13, 0x1d, 0x1e, 0x1f, 0x20, 0x1c, 0x1c, 0x1c, 0x1c, 0x1c, 0x1c, 0x1c, 0x1c, 0x18, 0x19, 0x1a, 0x1b, 0xf, 0x13, 0x13, 0xf, 0x21, 0x22, 0x23, 0x24, 0x1c, 0x25, 0x26, 0x26, 0x26, 0x26, 0x27, 0x1c, 0x1d, 0x1e, 0x1f, 0x20, 0x13, 0xf, 0xf, 0x13, 0xf, 0x13, 0x1c, 0x1c, 0x25, 0x28, 0x29, 0x2a, 0x2a, 0x2a, 0x2b, 0x27, 0x21, 0x22, 0x23, 0x24, 0xf, 0x13, 0x13, 0xf, 0x13, 0xf, 0x1c, 0x1c, 0x2c, 0x2a, 0x2a, 0x2a, 0x2a, 0x2a, 0x29, 0x2c, 0x1c, 0x1c, 0x13, 0xf, 0x13, 0xf, 0xf, 0x13, 0xf, 0x13, 0x1c, 0x1c, 0x2c, 0x2a, 0x2a, 0x29, 0x2a, 0x2a, 0x2a, 0x2c, 0x1c, 0x1c, 0xf, 0x13, 0xf, 0x13, 0x13, 0xf, 0x13, 0xf, 0x1c, 0x1c, 0x2c, 0x2a, 0x2a, 0x2a, 0x2a, 0x2a, 0x2a, 0x2c, 0x1c, 0x1c, 0x13, 0xf, 0x13, 0xf, 0xf, 0x13, 0xf, 0x13, 0x1c, 0x1c, 0x2b, 0x27, 0x2a, 0x2a, 0x2a, 0x2a, 0x25, 0x28, 0x1c, 0x1c, 0xf, 0x13, 0xf, 0x13, 0x13, 0xf, 0x13, 0xf, 0x1c, 0x1c, 0x1c, 0x2d, 0x2e, 0x2e, 0x2e, 0x2e, 0x2d, 0x1c, 0x1c, 0x1c, 0x13, 0xf, 0x13, 0xf, 0xf, 0x13, 0xf, 0x13, 0xf, 0x1c, 0x1c, 0x13, 0xf, 0x13, 0xf, 0x13, 0xf, 0x1c, 0x1c, 0x13, 0xf, 0x13, 0xf, 0x13, 0x13, 0xf, 0x13, 0xf, 0x13, 0xf, 0x13, 0xf, 0x13, 0xf, 0x13, 0xf, 0x13, 0xf, 0x13, 0xf, 0x13, 0xf, 0x13, 0xf, 0xf, 0x13, 0xf, 0x13, 0xf, 0x13, 0xf, 0x13, 0xf, 0x13, 0xf, 0x13, 0xf, 0x13, 0xf, 0x13, 0xf, 0x13, 0xf, 0x13, 0x13, 0xf, 0x13, 0xf, 0x13, 0xf, 0x13, 0xf, 0x13, 0xf, 0x13, 0xf, 0x13, 0xf, 0x13, 0xf, 0x13, 0xf, 0x13, 0xf, 0xf, 0x13, 0xf, 0x13, 0xf, 0x13, 0xf, 0x13, 0xf, 0x13, 0xf, 0x13, 0xf, 0x13, 0xf, 0x13, 0xf, 0x13, 0xf, 0x13, 0xf};


    // load the background tiles (vision henge scene)
    set_bkg_data(numHudTiles, 32, mytileset);
    // set_bkg_tiles(0, 0, 20, 18, mytilemap); // now that the windows tiles are loaded the vision henge tiles are pointing to the wrong tiles
    set_bkg_tiles(0, 0, 20, 18, modTilemap); // point to the shifted tiles instead

    
    // Load the HUD tiles into BG tile memory to test position
    // screen size is 18 tiles high
    // set_bkg_tiles(0, 17, 20, 1, zeldaMap);
    // move_bkg(0, 136); // 17 * 8

    // set windows tiles - this should work based on the above positions, but doesn't
    // set_win_tiles(0, 17, 20, 1, zeldaMap);
    // move_win(0, 136);

    // show the hud at the bottom of the screen instead
    set_win_tiles(0, 0, 20, 1, zeldaMap);
    move_win(6, 136);


    // flip the bg and windows layers to show the hud at the top of the screen
    set_bkg_tiles(0, 0, 20, 1, zeldaMap);
    set_win_tiles(0, 0, 20, 18, modTilemap);
    move_win(0, -8);    

    SHOW_BKG;
    SHOW_WIN;


    DISPLAY_ON;
}
